machine:
  pre:
    - wget http://dynamodb-local.s3-website-us-west-2.amazonaws.com/dynamodb_local_latest
    - tar -xvzf dynamodb_local_latest
    - java -Djava.library.path=./DynamoDBLocal_lib -jar DynamoDBLocal.jar --sharedDb:
        background: true
    - curl -Ls https://install.convox.com/linux.zip > /tmp/convox.zip
    - sudo unzip /tmp/convox.zip -d /usr/local/bin
    - convox login convox-pav-dev-629155429.us-east-1.elb.amazonaws.com --password DjJRSfKPKmAsZRlEsjDNDNCxBCjNtQ

  java:
    version: oraclejdk8
  services:
    - redis
    - elasticsearch
deployment:
  development:
    branch: master
    commands:
      - lein uberjar
      - convox deploy